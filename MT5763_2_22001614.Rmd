---
title: "MT5763_2_220021614"
author: "Nico Herrig"
date: "2022-10-15"
output: pdf_document
---

```{r}

library(tidyverse)
library(parallel)

```

## Problem 1

Description:
The problem presents two variables X and Y, where X ~ N($\mu$ = 4, $\sigma^2$ = 10) and 
Y ~ U(a = 2, b = 8). \
Compute $Pr(X > Y)$ and use bootstrapping to to derive the sampling distribution for your estimate of $Pr(X > Y)$. 
Show how the sample variance of this sampling distribution changes as a function of the number of Monte Carlo simulations. \
----------------------------------------------------------------------------------------------------------------------------

For the underlying problem, a sample containing 1e+5 (100*1000) random deviates from X ~ N($\mu$ = 4, $\sigma^2$ = 10) and Y ~ U(a = 2, b = 8) is used. To simulate "real-world conditions", the solution is obtained from only the below given vectors for X and Y.
```{r}

set.seed(0911)

probability_calculator <- function(n) {

  X <- rnorm(n, mean = 4, sd = sqrt(10))
  Y <- runif(n, min = 2, max = 8)

  # Calculating Pr(X>Y)
  Pr_hat <- sum(X > Y) / n
  
  output <- list(X, Y, Pr_hat)
  
  return(output)
}


results <- probability_calculator(100000)

print(results[3])

```  

Calculating $\bar Pr(X>Y)$ from the initial sample without any further methods, we derive a value of `r toString(Pr_hat)`.
To derive the distribution of $\bar Pr(X>Y)$, we use a non-parametric bootstrap. One benefit of this technique is that it does not rely on the assumption of normally distributed data.


```{r}
# creating function for bootstrap, using 8 cores (for completeness only).
bootstrap_multicore <- function(n_straps, vec1 = X, vec2 = Y) {
prob_vector <- unlist(mclapply(1:n_straps, function(n = n, vec1 = X, vec2 = Y) {
  resX <- vec1[sample(1 : length(vec1), length(vec1), replace = TRUE)]
  resY <- vec2[sample(1 : length(vec2), length(vec2), replace = TRUE)]
  
  Prob <- sum(resX > resY) / length(resX)
  return(Prob)
}, mc.cores = 8, mc.set.seed = TRUE))
return(prob_vector)
}

```



```{r}
# set seed for reproducibility
RNGkind("L'Ecuyer-CMRG")
set.seed(0112)


X <- unlist(results[1])
Y <- unlist(results[2])

prob_vec <- bootstrap_multicore(n_straps = 10000)

```

The bootstrap algorithm above re-samples the vectors X and Y *with replacement*, calculates the resulting $\bar Pr_i(X>Y)$, and repeats this procedure *n* times. The algorithm generates a vector (*prob_vector*) with *n*  probabilities. \
The distribution of $Pr(X>Y)$ can now be evaluated \


1. Using point estimates:
```{r}
quantile(prob_vec, c(0.025, 0.5, 0.975))
```


2. Using visualization (histogram):
```{r}
df_probabilities <- as.data.frame(prob_vec)

df_probabilities %>% 
ggplot(aes(x = prob_vec)) +
  geom_histogram(aes (y = ..density..),
                 bins = 20,
                 colour = 1,
                 fill = "white")+
  geom_density(lwd = 1.2,
               linetype = 2,
               colour = 2)+
  xlab("Pr(X>Y)")
```

Lastly, it is of interest how the sample variance of the sampling distribution changes with dependence on the bootstraps  

```{r}


```


```{r}


mclapply(1:5, function(i) {
  X_vec <- rnorm(i, mean = 4, sd = sqrt(10))
  Y_vec <- runif(i, min = 2, max = 8)
  
  
})

```


